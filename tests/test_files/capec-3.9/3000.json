{
	"Attack_Pattern_Catalog": {
		"Attack_Patterns": {
			"Attack_Pattern": [
				{
					"Description": "In applications, particularly web applications, access to functionality is mitigated by an authorization framework. This framework maps Access Control Lists (ACLs) to elements of the application's functionality; particularly URL's for web apps. In the case that the administrator failed to specify an ACL for a particular element, an attacker may be able to access it with impunity. An attacker with the ability to access functionality not properly constrained by ACLs can obtain sensitive information and possibly compromise the entire application. Such an attacker can access resources that must be available only to users at a higher privilege level, can access management sections of the application, or can run queries for data that they otherwise not supposed to.",
					"Likelihood_Of_Attack": "High",
					"Typical_Severity": "High",
					"Related_Attack_Patterns": {
						"Related_Attack_Pattern": [
							{
								"_Nature": "ChildOf",
								"_CAPEC_ID": "122"
							},
							{
								"_Nature": "CanPrecede",
								"_CAPEC_ID": "17"
							}
						]
					},
					"Execution_Flow": {
						"Attack_Step": [
							{
								"Step": "1",
								"Phase": "Explore",
								"Description": "[Survey] The attacker surveys the target application, possibly as a valid and authenticated user",
								"Technique": [
									"Spidering web sites for all available links",
									"Brute force guessing of resource names",
									"Brute force guessing of user names / credentials",
									"Brute force guessing of function names / actions"
								]
							},
							{
								"Step": "2",
								"Phase": "Explore",
								"Description": "[Identify Functionality] At each step, the attacker notes the resource or functionality access mechanism invoked upon performing specific actions",
								"Technique": [
									"Use the web inventory of all forms and inputs and apply attack data to those inputs.",
									"Use a packet sniffer to capture and record network traffic",
									"Execute the software in a debugger and record API calls into the operating system or important libraries. This might occur in an environment other than a production environment, in order to find weaknesses that can be exploited in a production environment."
								]
							},
							{
								"Step": "3",
								"Phase": "Experiment",
								"Description": "[Iterate over access capabilities] Possibly as a valid user, the attacker then tries to access each of the noted access mechanisms directly in order to perform functions not constrained by the ACLs.",
								"Technique": "Fuzzing of API parameters (URL parameters, OS API parameters, protocol parameters)"
							}
						]
					},
					"Prerequisites": {
						"Prerequisite": [
							"The application must be navigable in a manner that associates elements (subsections) of the application with ACLs.",
							"The various resources, or individual URLs, must be somehow discoverable by the attacker",
							"The administrator must have forgotten to associate an ACL or has associated an inappropriately permissive ACL with a particular navigable resource."
						]
					},
					"Skills_Required": {
						"Skill": {
							"_Level": "Low",
							"__text": "In order to discover unrestricted resources, the attacker does not need special tools or skills. They only have to observe the resources or access mechanisms invoked as each action is performed and then try and access those access mechanisms directly."
						}
					},
					"Resources_Required": {
						"Resource": "None: No specialized resources are required to execute this type of attack."
					},
					"Consequences": {
						"Consequence": {
							"Scope": [
								"Confidentiality",
								"Access Control",
								"Authorization"
							],
							"Impact": "Gain Privileges"
						}
					},
					"Mitigations": {
						"Mitigation": {
							"p": [
								{
									"__prefix": "xhtml",
									"__text": "In a J2EE setting, administrators can associate a role that is impossible for the authenticator to grant users, such as \"NoAccess\", with all Servlets to which access is guarded by a limited number of servlets visible to, and accessible by, the user."
								},
								{
									"__prefix": "xhtml",
									"__text": "Having done so, any direct access to those protected Servlets will be prohibited by the web container."
								},
								{
									"__prefix": "xhtml",
									"__text": "In a more general setting, the administrator must mark every resource besides the ones supposed to be exposed to the user as accessible by a role impossible for the user to assume. The default security setting must be to deny access and then grant access only to those resources intended by business logic."
								}
							]
						}
					},
					"Example_Instances": {
						"Example": {
							"p": [
								{
									"__prefix": "xhtml",
									"__text": "Implementing the Model-View-Controller (MVC) within Java EE's Servlet paradigm using a \"Single front controller\" pattern that demands that brokered HTTP requests be authenticated before hand-offs to other Action Servlets."
								},
								{
									"__prefix": "xhtml",
									"__text": "If no security-constraint is placed on those Action Servlets, such that positively no one can access them, the front controller can be subverted."
								}
							]
						}
					},
					"Related_Weaknesses": {
						"Related_Weakness": [
							{
								"_CWE_ID": "276"
							},
							{
								"_CWE_ID": "285"
							},
							{
								"_CWE_ID": "434"
							},
							{
								"_CWE_ID": "693"
							},
							{
								"_CWE_ID": "732"
							},
							{
								"_CWE_ID": "1191"
							},
							{
								"_CWE_ID": "1193"
							},
							{
								"_CWE_ID": "1220"
							},
							{
								"_CWE_ID": "1297"
							},
							{
								"_CWE_ID": "1311"
							},
							{
								"_CWE_ID": "1314"
							},
							{
								"_CWE_ID": "1315"
							},
							{
								"_CWE_ID": "1318"
							},
							{
								"_CWE_ID": "1320"
							},
							{
								"_CWE_ID": "1321"
							},
							{
								"_CWE_ID": "1327"
							}
						]
					},
					"Taxonomy_Mappings": {
						"Taxonomy_Mapping": {
							"Entry_ID": "1574.010",
							"Entry_Name": "Hijack Execution Flow: ServicesFile Permissions Weakness",
							"_Taxonomy_Name": "ATTACK"
						}
					},
					"Content_History": {
						"Submission": {
							"Submission_Name": "CAPEC Content Team",
							"Submission_Organization": "The MITRE Corporation",
							"Submission_Date": "2014-06-23"
						},
						"Modification": [
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2017-05-01",
								"Modification_Comment": "Updated Attack_Pattern, References"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2017-08-04",
								"Modification_Comment": "Updated Attack_Pattern, Description Summary"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2020-07-30",
								"Modification_Comment": "Updated Related_Weaknesses, Skills_Required, Taxonomy_Mappings"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2020-12-17",
								"Modification_Comment": "Updated Related_Attack_Patterns, Related_Weaknesses"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2021-06-24",
								"Modification_Comment": "Updated Related_Weaknesses"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2021-10-21",
								"Modification_Comment": "Updated Related_Weaknesses"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2022-09-29",
								"Modification_Comment": "Updated Related_Weaknesses"
							}
						]
					},
					"_ID": "1",
					"_Name": "Accessing Functionality Not Properly Constrained by ACLs",
					"_Abstraction": "Standard",
					"_Status": "Draft"
				},
				{
					"Description": {
						"p": [
							{
								"__prefix": "xhtml",
								"__text": "This type of attack against older telephone switches and trunks has been around for decades. A tone is sent by an adversary to impersonate a supervisor signal which has the effect of rerouting or usurping command of the line. While the US infrastructure proper may not contain widespread vulnerabilities to this type of attack, many companies are connected globally through call centers and business process outsourcing. These international systems may be operated in countries which have not upgraded Telco infrastructure and so are vulnerable to Blue boxing. Blue boxing is a result of failure on the part of the system to enforce strong authorization for administrative functions. While the infrastructure is different than standard current applications like web applications, there are historical lessons to be learned to upgrade the access control for administrative functions."
							},
							{
								"b": {
									"__prefix": "xhtml",
									"__text": "This attack pattern is included in CAPEC for historical purposes."
								},
								"__prefix": "xhtml"
							}
						]
					},
					"Likelihood_Of_Attack": "Medium",
					"Typical_Severity": "Very High",
					"Related_Attack_Patterns": {
						"Related_Attack_Pattern": {
							"_Nature": "ChildOf",
							"_CAPEC_ID": "220"
						}
					},
					"Prerequisites": {
						"Prerequisite": "System must use weak authentication mechanisms for administrative functions."
					},
					"Skills_Required": {
						"Skill": {
							"_Level": "Low",
							"__text": "Given a vulnerable phone system, the attackers' technical vector relies on attacks that are well documented in cracker 'zines and have been around for decades."
						}
					},
					"Resources_Required": {
						"Resource": "CCITT-5 or other vulnerable lines, with the ability to send tones such as combined 2,400 Hz and 2,600 Hz tones to the switch"
					},
					"Consequences": {
						"Consequence": [
							{
								"Scope": "Availability",
								"Impact": "Resource Consumption",
								"Note": "Denial of Service"
							},
							{
								"Scope": [
									"Confidentiality",
									"Access Control",
									"Authorization"
								],
								"Impact": "Gain Privileges"
							}
						]
					},
					"Mitigations": {
						"Mitigation": [
							"Implementation: Upgrade phone lines. Note this may be prohibitively expensive",
							"Use strong access control such as two factor access control for administrative access to the switch"
						]
					},
					"Example_Instances": {
						"Example": "An adversary identifies a vulnerable CCITT-5 phone line, and sends a combination tone to the switch in order to request administrative access. Based on tone and timing parameters the request is verified for access to the switch. Once the adversary has gained control of the switch launching calls, routing calls, and a whole host of opportunities are available."
					},
					"Related_Weaknesses": {
						"Related_Weakness": {
							"_CWE_ID": "285"
						}
					},
					"References": {
						"Reference": {
							"_External_Reference_ID": "REF-1"
						}
					},
					"Content_History": {
						"Submission": {
							"Submission_Name": "CAPEC Content Team",
							"Submission_Organization": "The MITRE Corporation",
							"Submission_Date": "2014-06-23"
						},
						"Modification": [
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2019-04-04",
								"Modification_Comment": "Updated Related_Weaknesses"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2023-01-24",
								"Modification_Comment": "Updated @Status, Description"
							}
						]
					},
					"_ID": "5",
					"_Name": "Blue Boxing",
					"_Abstraction": "Detailed",
					"_Status": "Obsolete"
				},
				{
					"Description": {
						"p": {
							"__prefix": "xhtml",
							"__text": "An adversary guesses or obtains (i.e. steals or purchases) legitimate credentials (e.g. userID/password) to achieve authentication and to perform authorized actions under the guise of an authenticated user or service."
						}
					},
					"Extended_Description": {
						"p": [
							{
								"__prefix": "xhtml",
								"__text": "Attacks leveraging trusted credentials typically result in the adversary laterally moving within the local network, since users are often allowed to login to systems/applications within the network using the same password. This further allows the adversary to obtain sensitive data, download/install malware on the system, pose as a legitimate user for social engineering purposes, and more."
							},
							{
								"__prefix": "xhtml",
								"__text": "Attacks on known passwords generally rely on the primary fact that users often reuse the same username/password combination for a variety of systems, applications, and services, coupled with poor password policies on the target system or application. Adversaries can also utilize known passwords to target Single Sign On (SSO) or cloud-based applications and services, which often don't verify the authenticity of the user's input. Known credentials are usually obtained by an adversary via a system/application breach and/or by purchasing dumps of credentials on the dark web. These credentials may be further gleaned via exposed configuration and properties files that contain system passwords, database connection strings, and other sensitive data."
							}
						]
					},
					"Likelihood_Of_Attack": "High",
					"Typical_Severity": "High",
					"Related_Attack_Patterns": {
						"Related_Attack_Pattern": {
							"_Nature": "CanPrecede",
							"_CAPEC_ID": "151"
						}
					},
					"Execution_Flow": {
						"Attack_Step": [
							{
								"Step": "1",
								"Phase": "Explore",
								"Description": "[Acquire known credentials] The adversary must obtain known credentials in order to access the target system, application, or service.",
								"Technique": [
									"An adversary purchases breached username/password combinations or leaked hashed passwords from the dark web.",
									"An adversary leverages a key logger or phishing attack to steal user credentials as they are provided.",
									"An adversary conducts a sniffing attack to steal credentials as they are transmitted.",
									"An adversary gains access to a database and exfiltrates password hashes.",
									"An adversary examines outward-facing configuration and properties files to discover hardcoded credentials."
								]
							},
							{
								"Step": "2",
								"Phase": "Explore",
								"Description": "[Determine target's password policy] Determine the password policies of the target system/application to determine if the known credentials fit within the specified criteria.",
								"Technique": [
									"Determine minimum and maximum allowed password lengths.",
									"Determine format of allowed passwords (whether they are required or allowed to contain numbers, special characters, etc., or whether they are allowed to contain words from the dictionary).",
									"Determine account lockout policy (a strict account lockout policy will prevent brute force attacks if multiple passwords are known for a single user account)."
								]
							},
							{
								"Step": "3",
								"Phase": "Experiment",
								"Description": "[Attempt authentication] Try each credential until the target grants access.",
								"Technique": "Manually or automatically enter each credential through the target's interface."
							},
							{
								"Step": "4",
								"Phase": "Exploit",
								"Description": "[Impersonate] An adversary can use successful experiments or authentications to impersonate an authorized user or system, or to laterally move within a system or application"
							},
							{
								"Step": "5",
								"Phase": "Exploit",
								"Description": "[Spoofing] Malicious data can be injected into the target system or into a victim user's system by an adversary. The adversary can also pose as a legitimate user to perform social engineering attacks."
							},
							{
								"Step": "6",
								"Phase": "Exploit",
								"Description": "[Data Exfiltration] The adversary can obtain sensitive data contained within the system or application."
							}
						]
					},
					"Prerequisites": {
						"Prerequisite": [
							"The system/application uses one factor password based authentication, SSO, and/or cloud-based authentication.",
							"The system/application does not have a sound password policy that is being enforced.",
							"The system/application does not implement an effective password throttling mechanism.",
							"The adversary possesses a list of known user accounts and corresponding passwords that may exist on the target."
						]
					},
					"Skills_Required": {
						"Skill": {
							"_Level": "Low",
							"__text": "Once an adversary obtains a known credential, leveraging it is trivial."
						}
					},
					"Resources_Required": {
						"Resource": [
							"A list of known credentials.",
							"A custom script that leverages the credential list to launch an attack."
						]
					},
					"Indicators": {
						"Indicator": [
							"Authentication attempts use credentials that have been used previously by the account in question.",
							"Authentication attempts are originating from IP addresses or locations that are inconsistent with the user's normal IP addresses or locations.",
							"Data is being transferred and/or removed from systems/applications within the network.",
							"Suspicious or Malicious software is downloaded/installed on systems within the domain.",
							"Messages from a legitimate user appear to contain suspicious links or communications not consistent with the user's normal behavior."
						]
					},
					"Consequences": {
						"Consequence": [
							{
								"Scope": [
									"Confidentiality",
									"Access Control",
									"Authentication"
								],
								"Impact": "Gain Privileges"
							},
							{
								"Scope": [
									"Confidentiality",
									"Authorization"
								],
								"Impact": "Read Data"
							},
							{
								"Scope": "Integrity",
								"Impact": "Modify Data"
							}
						]
					},
					"Mitigations": {
						"Mitigation": [
							"Leverage multi-factor authentication for all authentication services and prior to granting an entity access to the domain network.",
							"Create a strong password policy and ensure that your system enforces this policy.",
							"Ensure users are not reusing username/password combinations for multiple systems, applications, or services.",
							"Do not reuse local administrator account credentials across systems.",
							"Deny remote use of local admin credentials to log into domain systems.",
							"Do not allow accounts to be a local administrator on more than one system.",
							"Implement an intelligent password throttling mechanism. Care must be taken to assure that these mechanisms do not excessively enable account lockout attacks such as CAPEC-2.",
							"Monitor system and domain logs for abnormal credential access."
						]
					},
					"Example_Instances": {
						"Example": [
							"Throughout 2015 and 2016, APT28 — also known as Pawn Storm, Sednit, Fancy Bear, Sofacy, and STRONTIUM — leveraged stolen credentials to infiltrate the Democratic National Committee (DNC), the United States Army, the World Anti-Doping Agency (WADA), the Court of Arbitration for Sport (TAS-CAS), and more. In most cases, the legitimate credentials were obtained via calculated spearphishing, tabnabbing, and DNS attacks targeted at corporate webmail systems. APT28 also executed several watering hole attacks, in addition to exploiting several zero-day vulnerabilities within Flash and Windows. The stolen credentials were then utilized to maintain authenticated access, laterally move within the local network, and exfiltrate sensitive information including DNC emails and personal medical records of numerous athletes. [REF-571]",
							"In early 2019, FIN6 exploited stolen credentials from an organization within the engineering industry to laterally move within an environment via the Windows’ Remote Desktop Protocol (RDP). Multiple servers were subsequently infected with malware to create malware distribution servers, which were used to distribute the LockerGoga ransomware. [REF-573]"
						]
					},
					"Related_Weaknesses": {
						"Related_Weakness": [
							{
								"_CWE_ID": "522"
							},
							{
								"_CWE_ID": "307"
							},
							{
								"_CWE_ID": "308"
							},
							{
								"_CWE_ID": "309"
							},
							{
								"_CWE_ID": "262"
							},
							{
								"_CWE_ID": "263"
							},
							{
								"_CWE_ID": "654"
							},
							{
								"_CWE_ID": "1273"
							}
						]
					},
					"Taxonomy_Mappings": {
						"Taxonomy_Mapping": {
							"Entry_ID": "1078",
							"Entry_Name": "Valid Accounts",
							"_Taxonomy_Name": "ATTACK"
						}
					},
					"References": {
						"Reference": [
							{
								"_External_Reference_ID": "REF-570"
							},
							{
								"_External_Reference_ID": "REF-571"
							},
							{
								"_External_Reference_ID": "REF-572"
							},
							{
								"_External_Reference_ID": "REF-573"
							}
						]
					},
					"Content_History": {
						"Submission": {
							"Submission_Name": "CAPEC Content Team",
							"Submission_Organization": "The MITRE Corporation",
							"Submission_Date": "2015-11-09"
						},
						"Modification": [
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2015-12-07",
								"Modification_Comment": "Updated References"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2018-07-31",
								"Modification_Comment": "Updated References"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2019-04-04",
								"Modification_Comment": "Updated Related_Weaknesses, Taxonomy_Mappings"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2020-07-30",
								"Modification_Comment": "Updated @Abstraction, @Status, Consequences, Description, Example_Instances, Execution_Flow, Indicators, Likelihood_Of_Attack, Mitigations, Prerequisites, References, Related_Attack_Patterns, Related_Weaknesses, Resources_Required, Skills_Required, Taxonomy_Mappings, Typical_Severity"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2021-06-24",
								"Modification_Comment": "Updated Taxonomy_Mappings"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2022-02-22",
								"Modification_Comment": "Updated Description, Extended_Description"
							},
							{
								"Modification_Name": "CAPEC Content Team",
								"Modification_Organization": "The MITRE Corporation",
								"Modification_Date": "2022-09-29",
								"Modification_Comment": "Updated Extended_Description, Taxonomy_Mappings"
							}
						]
					},
					"_ID": "560",
					"_Name": "Use of Known Domain Credentials",
					"_Abstraction": "Meta",
					"_Status": "Stable"
				}
			]
		},
		"_xmlns": "http://capec.mitre.org/capec-3",
		"_xmlns:xhtml": "http://www.w3.org/1999/xhtml",
		"_xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
		"_Name": "VIEW LIST: CAPEC-3000: Domains of Attack",
		"_Version": "3.9",
		"_Date": "2023-01-24",
		"_xsi:schemaLocation": "http://capec.mitre.org/capec-3 http://capec.mitre.org/data/xsd/ap_schema_v3.5.xsd"
	}
}